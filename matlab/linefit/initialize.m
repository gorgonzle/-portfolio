%---------------------------- PSO fitting --------------------------------%
% Writer: Minsang Kim                                                     %
%Date 2024-06-17                                                          %
%-------------------------------------------------------------------------%
function x = initialize(opt,space)
    lb = space.lb; ub = space.ub; numpar = space.numpar;
    %normalize
    input_lb = log_10normalize(lb,opt.log10comp);
    input_ub = log_10normalize(ub,opt.log10comp);
    
    switch(opt.mode)
        case('range');      position = range(input_lb,input_ub,numpar);
        case('nomal');      position = normal(input_lb,input_ub,numpar);
        case('Latin');      position = Latin(input_lb,input_ub,numpar);
        case('custom');     position = Custom();
        otherwise
            error('Invalid mode selected. Use range, normal or Latin.');
    end
    x = position;
%----------------------------------------------------------Uniform sampling
function position =range(lb,ub,numpar)
    position = lb + (ub - lb) .* rand(numpar, numDimensions);
%-------------------------------------------------------Normal distribution
function position = normal(lb,ub,numpar)
    center = lb;
    stdDev = ub;
    position = center + stdDev .* randn(numpar, numDimensions);
    %Use lb as nomal and ub as Distribution
%-----------------------------------------------------------Latin hypercube
function position = Latin(lb,ub,numpar)
    dist = lhsdesign(numpar,4).';
    position = lb + (ub-lb).*dist;
%-----------------------------------------------------------custom sampling
function position = Custom()
    position = [
    -12.5126	1.3558	-0.7276	1.4121e+04
    -19.9497	1.7729	-0.4111	2.9799e+04
    -17.8894	2.0291	-0.2754	1.2714e+04
    -15.5779	1.8884	-0.4312	2.6583e+04
    -14.2211	1.5367	-0.5769	2.3568e+04
    -16.8844	1.2754	-1.0593	1.9749e+04
    -19.3467	2.1698	-0.6372	2.0553e+04
    -17.2362	1.3759	-0.9990	2.4774e+04
    -18.5930	2.1598	-1.0141	1.7940e+04
    -11.3065	1.6020	-0.5819	2.8894e+04
    -15.2764	1.5719	-1.0191	1.1809e+04
    -13.4171	1.5970	-0.5166	1.7538e+04
    -17.3367	1.4663	-0.4412	2.9698e+04
    -15.0754	1.7427	-0.8633	1.4422e+04
    -16.0302	1.3206	-0.4362	2.7889e+04
    -12.7136	2.0492	-0.8784	2.5075e+04
    -16.8342	1.4563	-0.5869	2.1357e+04
    -12.3618	1.4111	-0.3658	1.9849e+04
    -18.1407	1.9688	-1.1799	2.9497e+04
    -13.3668	1.4513	-0.8030	2.6382e+04
    -19.3970	1.7879	-0.7327	2.1759e+04
    -12.5628	1.5317	-0.9839	1.6332e+04
    -16.0804	1.4010	-1.0040	1.5126e+04
    -18.8945	1.9940	-0.4563	1.5829e+04
    -10.1508	1.2000	-0.6020	2.7387e+04
    -12.2111	1.3055	-0.7477	1.1407e+04
    -11.4573	1.4613	-0.2452	1.1608e+04
    -12.8643	2.0141	-0.3910	2.1156e+04
    -15.8291	1.4261	-1.0894	2.2663e+04
    -17.9899	2.1950	-0.5518	1.4824e+04
    -17.7387	1.9839	-1.0945	1.4623e+04
    -17.8392	1.2653	-0.7930	2.8492e+04
    -14.8744	1.2101	-0.2251	1.0402e+04
    -14.5729	1.9538	-0.6623	1.3015e+04
    -19.7487	1.2955	-1.1196	1.7638e+04
    -14.7739	1.6673	-1.1095	1.2412e+04
    -13.0151	1.7226	-0.2603	1.1709e+04
    -11.0050	1.4864	-0.5317	2.6683e+04
    -15.9296	1.6523	-0.7025	2.7990e+04
    -17.0854	1.8231	-0.4663	1.4724e+04
    -17.5879	1.6422	-1.1447	1.7437e+04
    -14.5226	1.4412	-0.2402	2.9296e+04
    -11.8090	1.5869	-0.2050	2.1960e+04
    -14.6231	2.1799	-0.6925	1.8744e+04
    -15.6281	2.1849	-0.7729	2.4975e+04
    -13.7688	1.6322	-1.1146	1.8543e+04
    -19.2462	1.9035	-0.5015	2.9095e+04
    -11.1558	1.3658	-0.8332	2.5779e+04
    -18.6432	1.7779	-0.3558	2.2261e+04
    -13.6181	2.1497	-0.8734	1.5930e+04
    -14.8241	1.3960	-0.4462	1.6030e+04
    -17.0352	2.1548	-0.5920	1.9347e+04
    -18.0905	1.8834	-1.0543	2.6482e+04
    -13.4673	2.0995	-0.7779	1.5729e+04
    -13.2161	2.1296	-0.3508	30000
    -19.4472	1.2553	-0.5417	2.7487e+04
    -13.2663	1.8935	-0.6824	1.9246e+04
    -16.4322	2.0643	-0.2704	1.4322e+04
    -19.5980	1.7126	-1.0995	1.3719e+04
    -14.6734	1.7276	-1.1698	2.0050e+04
    -17.9397	1.8583	-1.0693	2.6080e+04
    -12.3116	1.3256	-0.6422	2.2864e+04
    -11.0553	1.8533	-0.5065	1.4523e+04
    -15.9799	2.0543	-0.2101	2.9196e+04
    -18.3920	1.8382	-1.0844	2.3166e+04
    -10.7035	2.1749	-0.7126	1.0101e+04
    -11.7588	1.2804	-0.2955	2.3065e+04
    -16.1307	1.6171	-0.7829	1.6533e+04
    -16.3317	1.7075	-0.9789	2.0352e+04
    -15.5276	2.0844	-0.8884	1.3216e+04
    -18.2915	1.8080	-0.5719	2.4472e+04
    -13.5176	2.1146	-1.0643	2.2161e+04
    -10.5025	1.8985	-0.4613	1.2915e+04
    -11.9598	1.7930	-0.9236	1.5427e+04
    -19.6482	2.1397	-0.6322	2.1558e+04
    -16.9347	1.4764	-0.6121	1.9548e+04
    -19.0452	2.0693	-0.4915	1.1910e+04
    -10.4523	1.4915	-0.3206	1.7236e+04
    -10.8543	1.7176	-0.7528	2.7186e+04
    -17.1859	1.9186	-0.6774	2.1055e+04
    -11.2563	1.9789	-0.2653	1.9146e+04
    -19.8995	1.3407	-1.0392	2.4673e+04
    -16.2814	1.2352	-1.1849	1.6734e+04
    -11.2060	1.7377	-0.4714	1.1005e+04
    -12.6131	1.8482	-1.0291	2.6181e+04
    -11.5075	1.3608	-0.2000	1.7035e+04
    -14.9749	1.5216	-1.1648	2.8794e+04
    -14.2714	1.8432	-0.8432	2.5980e+04
    -11.5578	1.9638	-0.4060	1.3116e+04
    -10.9045	2.0090	-0.4814	2.1859e+04
    -18.3417	1.5266	-0.7427	2.9397e+04
    -19.1960	2.1095	-0.8382	2.7789e+04
    -20	2.0191	-1.0744	2.0955e+04
    -10.3015	1.6975	-0.4513	2.3769e+04
    -16.6834	1.7528	-0.4261	2.7688e+04
    -19.7990	1.4714	-0.2503	1.1307e+04
    -12.4623	2.0894	-0.4965	1.5628e+04
    -14.3216	1.5668	-0.5467	1.6633e+04
    -16.1809	1.7628	-0.3759	1.8342e+04
    -15.8794	1.8181	-0.4864	1.6131e+04
    -14.1206	1.5819	-0.9136	2.3869e+04
    -13.8191	1.6372	-1.0241	2.1658e+04
    -15.6784	1.8332	-0.8533	2.3367e+04
    -17.5377	1.3106	-0.9035	2.4372e+04
    -10.2010	1.9286	-1.1497	2.8693e+04
    -13.3166	1.6472	-0.9739	1.2312e+04
    -19.6985	1.7025	-0.9487	1.6231e+04
    -10	1.3809	-0.3256	1.9045e+04
    -10.8040	1.2905	-0.5618	1.2211e+04
    -11.6583	1.8734	-0.6573	1.0603e+04
    -19.0955	1.3910	-0.9186	1.8141e+04
    -18.4422	1.4362	-0.9940	2.6884e+04
    -15.7286	1.5568	-0.5568	1.4020e+04
    -15.0251	1.8784	-0.2352	1.1206e+04
    -18.4925	2.0392	-1.2000	2.2965e+04
    -17.3869	1.5518	-0.3709	1.3819e+04
    -18.7940	1.6623	-0.9286	2.8995e+04
    -13.7186	2.1648	-0.2151	2.3266e+04
    -10.1005	2.0593	-0.3608	1.5327e+04
    -18.7437	1.4211	-1.1347	2.0854e+04
    -12.8141	1.4814	-0.7226	1.8945e+04
    -19.1457	1.6824	-0.6472	1.2814e+04
    -19.5477	1.9085	-1.0794	2.2764e+04
    -10.9548	1.3307	-0.9085	2.8090e+04
    -13.0653	1.9236	-0.7879	2.0452e+04
    -10.3518	1.2603	-0.7678	1.8442e+04
    -18.0402	1.6070	-0.4764	2.4573e+04
    -19.4975	1.5015	-0.9387	2.7085e+04
    -16.4824	1.2854	-0.3357	1.7839e+04
    -11.7085	1.5920	-0.8281	1.5528e+04
    -14.4724	1.3156	-0.5116	2.6784e+04
    -13.6683	1.6925	-0.4211	1.9648e+04
    -13.8693	1.7829	-0.6171	2.3467e+04
    -18.2412	2.1196	-1.1045	1.6935e+04
    -19.2965	1.2251	-0.6874	2.9899e+04
    -11.6080	1.5618	-0.3156	1.6834e+04
    -14.0201	1.3457	-1.1899	1.0804e+04
    -18.9447	1.5467	-0.8935	2.5477e+04
    -17.6884	2.0744	-0.7578	1.7136e+04
    -12.0603	1.5417	-0.3307	1.3920e+04
    -15.3266	1.6724	-0.2302	1.9950e+04
    -10.4020	1.6874	-0.3005	2.6281e+04
    -13.5678	1.3357	-1.1296	2.5678e+04
    -16.7337	1.5065	-0.7176	2.0754e+04
    -10.5528	2.1447	-0.8583	1.2513e+04
    -16.7839	1.2704	-1.0492	10000
    -16.5327	1.3005	-0.6221	2.4271e+04
    -11.9095	1.5166	-0.3457	1.3518e+04
    -12.9648	1.2452	-0.8080	2.0653e+04
    -15.1759	2.0040	-0.9538	2.3970e+04
    -16.3819	1.2503	-0.5266	2.4070e+04
    -11.3568	1.6221	-1.0442	1.7739e+04
    -18.8442	2.0342	-0.5668	1.4221e+04
    -10.7538	1.4965	-0.8985	1.0905e+04
    -16.2312	1.7678	-0.2854	2.1457e+04
    -14.3719	1.2151	-0.6271	1.5025e+04
    -15.3769	1.2201	-0.7075	2.1256e+04
    -18.1910	1.8131	-1.1950	1.8040e+04
    -15.4774	1.9588	-1.1598	1.0704e+04
    -12.4121	1.7578	-0.2553	2.2563e+04
    -12.9146	1.5769	-0.9337	2.5276e+04
    -14.0704	1.7477	-0.6975	1.2010e+04
    -18.9950	1.9136	-0.8683	1.3317e+04
    -16.9849	1.6774	-1.1397	2.8291e+04
    -15.2261	1.7327	-0.2905	2.7588e+04
    -10.2513	2.1045	-0.2804	2.2362e+04
    -15.4271	1.4462	-0.7377	2.6985e+04
    -15.1256	2.1899	-1.1749	2.9598e+04
    -12.1608	2.1347	-0.6070	1.1508e+04
    -12.2613	1.4161	-0.3055	2.5377e+04
    -12.0101	1.2050	-0.8482	2.5176e+04
    -14.1709	1.9739	-0.3106	1.7337e+04
    -17.1357	1.3859	-1.0090	1.8844e+04
    -18.5427	1.9387	-1.1548	2.8392e+04
    -17.7889	2.0945	-0.6523	2.8593e+04
    -19.8492	2.2000	-0.7980	1.2613e+04
    -11.1055	1.4060	-0.9437	2.4171e+04
    -13.9196	1.9990	-0.3960	2.4874e+04
    -17.4372	1.8683	-0.4161	2.3668e+04
    -10.6030	1.6121	-0.6673	1.8241e+04
    -16.6332	1.9487	-0.5970	1.3618e+04
    -11.8593	1.4312	-0.2201	1.0503e+04
    -17.6382	1.9889	-1.0342	2.0151e+04
    -13.1658	1.9437	-0.8131	1.8643e+04
    -17.2864	1.3508	-0.5216	1.4925e+04
    -13.9698	2.0794	-0.9638	1.2111e+04
    -14.9246	1.6573	-0.5367	2.5578e+04
    -12.6633	1.9337	-0.9588	1.0302e+04
    -16.5829	1.8030	-0.8834	2.2462e+04
    -14.7236	1.8281	-0.3809	2.8191e+04
    -18.6935	1.7980	-0.8181	1.1106e+04
    -11.4070	1.2402	-0.3859	2.2060e+04
    -12.7638	2.0241	-0.4010	1.5226e+04
    -10.6533	1.2302	-0.7628	1.9447e+04
    -13.1156	2.1246	-0.3407	2.0251e+04
    -15.7789	1.8633	-0.8231	1.6432e+04
    -14.4221	1.5116	-0.9688	1.3417e+04
    -12.1106	1.3709	-1.1246	2.7286e+04
    -10.0503	1.6271	-0.9889	1.0201e+04
    -17.4874	2.0442	-0.6724	2.5879e+04
        ];
%------------------------------------------------------------data normalize
function data = log_10normalize(data,indices)
for i = 1:length(indices)
    data(indices(i)) = log10(data(indices(i)));
end
